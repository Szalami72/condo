<app-menu></app-menu>

<div class="container mb-4">

    <h2 class="mb-4">Óraállások</h2>

    <app-message></app-message>

    <div class="row row-cols-auto justify-content-between">

        <div class="col h-100 header-items">
            <ngb-pagination [collectionSize]="filteredUsers.length" [(page)]="page" [pageSize]="pageSize" [maxSize]="3" [rotate]="false" [ellipses]="true" [boundaryLinks]="false">
            </ngb-pagination>
          </div>
        
          <div class="col h-100 header-items">
              <span>Lakó/oldal:</span>
              <select class="form-select-sm ms-2" [(ngModel)]="pageSize" (change)="onPageSizeChange()">
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
              </select>
          </div>
        
          <div class="col h-100 header-items mb-4">
            <div class="col h-100 header-items justify-content-end">
              <input type="text" class="search-input ps-2" placeholder="keresés..." [(ngModel)]="searchTerm" (input)="filterUsers()">
            </div>
          </div>
        
        </div>

        <div *ngIf="filteredUsers && filteredUsers.length > 0; else noData">

          <div class="">
              <div class="header row cursor-pointer bg-secondary text-white p-2 mb-3">
                <div class="col">
                  <span (click)="sortUsers('username')"
                  [ngClass]="{'sorted-column': sortedColumn === 'username'}">
                    Lakó neve
                    <i [ngClass]="{'sorted-column': sortedColumn === 'username'}" 
                       class="fa-solid fa-arrow-down fa-xs ms-2">
                    </i>
                  </span>
                  <span (click)="sortUsers('typeOfBuildings')" 
                    [ngClass]="{'sorted-column': sortedColumn === 'typeOfBuildings'}" 
                    class="ms-4">
                    / lakás
                    <i [ngClass]="{'sorted-column': sortedColumn === 'typeOfBuildings'}" 
                       class="fa-solid fa-arrow-down fa-xs ms-2">
                    </i>
                  </span>
                </div>
                <div class="col text-end" (click)="justEmptyFields()"
                [ngClass]="{'sorted-column': filterEmptyFields}">
                  Leadatlanok
                </div>
              </div>

              <div class="user-list row" *ngFor="let filteredUser of filteredUsers | slice: (page-1) * pageSize : (page-1) * pageSize + pageSize">
                <div class="col-lg-2 col-md-12 col-sm-12 mb-3">
                  <b>{{ filteredUser.username }}</b>
               <br>
                  <span class="" *ngIf="filteredUser.typeOfBuildings != '' && filteredUser.typeOfFloors != '' && filteredUser.typeOfDoors != ''">
                    {{ filteredUser.typeOfBuildings }}/{{ filteredUser.typeOfFloors }}/{{ filteredUser.typeOfDoors }}
                  </span>
                </div>
                  
                <div class="col text-center" *ngIf="meterData.cold1 != ''">Hideg1: 
                    <input class="w-100 text-center border border-primary-subtle  bg-primary-subtle" type="number" name="cold1" [(ngModel)]="filteredUser.cold1">
                  </div>

                  <div class="col text-center" *ngIf="meterData.cold2 != ''">Hideg2: 
                    <input class="w-100 text-center border border-primary-subtle  bg-primary-subtle" type="number" name="cold2" [(ngModel)]="filteredUser.cold2">
                  </div>

                  <div class="col text-center" *ngIf="meterData.hot1 != ''">Meleg1: 
                    <input class="w-100 text-center border border-danger-subtle bg-danger-subtle" type="number" name="hot1" [(ngModel)]="filteredUser.hot1">
                  </div>

                  <div class="col text-center" *ngIf="meterData.hot2 != ''">Meleg2: 
                    <input class="w-100 text-center border border-danger-subtle bg-danger-subtle" type="number" name="hot2" [(ngModel)]="filteredUser.hot2">
                  </div>

                  <div class="col text-center" *ngIf="meterData.heating != ''">Fűtés: 
                    <input class="w-100 text-center border border-warning-subtle bg-warning-subtle" type="number" name="heating" [(ngModel)]="filteredUser.heating">
                  </div>
                  
                  <div class="col text-center mt-4 mb-2">
                    <button class="btn btn-sm btn-primary" (click)="saveMetersById(filteredUser.userId)">Mentés</button>
                  </div>

                <hr>
              </div>
              
            </div>
        
            </div>  


        
            <ng-template #noData>
                <p>Nincs megjeleníthető adat.</p>
              </ng-template>

        



</div>